
@using BusinessExcel.Providers.ProviderContext.Entities
@using BusinessExcel.Providers.ProviderContext

@{

    using (var db = new SalesManageDataContext())
    {
        int count = 0;
        var data = db.DailyUpateViewPaging(pageNumber: ViewBag.DailyUpateViewPage,
            pageSize: 10,
            sort: ViewBag.DailyUpateViewSort,
            sortdir: ViewBag.DailyUpateViewDir,
            count: out count
            );
        var grid = new WebGrid(ajaxUpdateContainerId: "table-daily-upate-view",
            ajaxUpdateCallback: "TableDailyUpateView"
            );
        grid.Bind(source: data, autoSortAndPage: false, rowCount: count);

        @grid.GetHtml(
                           tableStyle: "table table-striped table-bordered",
                           htmlAttributes: new { @id = "example" },
                           columns: new[] {
                               grid.Column(columnName:"Name",header:"Name",format:null,style:null,canSort:false),
                               grid.Column(columnName:"UserName",header:"User Name",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Location",header:"Location",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Brand",header:"Brand",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Category",header:"Category",format:null,style:null,canSort:false),
                               grid.Column(columnName:"CreateTime",header:"Create Time",format:x=>string.Format("{0:dd-MMM-yyyy}",x.CreateTime),style:null,canSort:true),
                               grid.Column(columnName:"Item",header:"Item",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Description",header:"Description",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Quantity",header:"Quantity",format:null,style:null,canSort:false),
                               grid.Column(columnName:"Value",header:"Value",format:null,style:null,canSort:false)
                           })
    }
}