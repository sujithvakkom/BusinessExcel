@*@model BusinessExcel.Models.RolesNameModel*@
@using BootstrapHtmlHelper

<table id="example" class="table table-striped table-bordered" style="width:100%">
    <thead>
        <tr>
            <td>User Name</td>
            <td>Email</td>
        </tr>
    </thead>
    @{
        var users = from user in Membership.GetAllUsers().Cast<MembershipUser>()
                    where (user).IsApproved == false
                    select user;
    }
    @foreach (MembershipUser user in users)
    {
        <tr>
            <td>
                @user.ToString()
                @using (Ajax.BeginForm(
actionName: BusinessExcel.Controllers.AdminController.AJAXENABLEUSER,
routeValues: "",
ajaxOptions: new AjaxOptions()
{
    //UpdateTargetId = "role-table-display",
    //InsertionMode = InsertionMode.Replace,
    OnSuccess = "refreshUserRequestTable('enable-user-confirm-" + @user.UserName.Replace(' ', '-') + "')"//, Confirm = "Do you want to remove role?"
},
htmlAttributes: new { @style = "display:inline;", @id = "form-user-enable-" + user.UserName.Replace(' ', '-') }
))
                {
                    @Html.Hidden("UserName", user.ToString())
                        <!-- Button trigger modal -->
                    <button type="button" class="btn btn-link" data-toggle="modal" data-target="#enable-user-confirm-@user.UserName.Replace(' ', '-')">
                        Enable
                    </button>

                        <!-- Modal -->
                    <div class="modal fade" id="enable-user-confirm-@user.UserName.Replace(' ', '-')" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="remove-role-confirm-label@{@user.ToString().Replace(' ', '-')}">Enable User</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    Do you want to enable user : <b>@user.ToString()</b>?<br />
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-primary" onclick='confirmApproveUser("form-user-enable-@user.UserName.Replace(' ', '-')")' data-dismiss="modal">Approve</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*<button type="submit" class="btn btn-link">Remove</button>*@<button type="submit" class="btn btn-link"></button>
    }

            </td>
            <td>@user.Email</td>
        </tr>

    }
</table>

@*@Html.Hidden("RolesName",
    null,
    new Dictionary<string, object>() { { "class", "form-control" }, { "required", "" }, { "value", role }, { "value", role } },
    null,
    null,
    "",
    false,
    true,
    true)*@<string, object>
    @*<button id='remove-@{@role}' type="button" class="btn btn-link" onclick='confirmRemoveRole("form-remove@{@role}")'>Remove</button>*@
    @*<button id='remove-@{@role}' type="button" class="btn btn-link" onclick='confirmRemoveRole("form-remove@{@role}")'></button>*@
    @*//Setting id and type*@




        <script>
            function refreshUserRequestTable() {
                $.ajax({
                    // edit to add steve's suggestion.
                    //url: "/ControllerName/ActionName",
                    url: '@Url.Action(BusinessExcel.Controllers.AdminController.USERREQUESTTABLEPARTIAL, BusinessExcel.Controllers.AdminController.ADMIN)',
                    success: function (data) {
                        // your data could be a View or Json or what ever you returned in your action method
                        // parse your data here
                        //alert(data);
                        $('#user-approval-table-display').modal('hide')
                        $('#user-approval-table-display').html(data)
                    }
                });
            }

            function confirmApproveUser(formid) {
                $("#" + formid).submit();
            }
        </script>
