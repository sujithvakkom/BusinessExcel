@using BusinessExcel.Models
@using BusinessExcel.Providers.ProviderContext.Entities
@using BusinessExcel.Providers.ProviderContext
@using BusinessExcel.Controllers.JSON
@using BusinessExcel.Controllers
@using BootstrapHtmlHelper

@model BaseTarget
<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        @TargetController.TARGET
        <small>@TargetController.TARGETDISTRIBUTION_TITLE</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i>@TargetController.TARGETDISTRIBUTION_TITLE</a></li>
        <li class="active">@AccountsController.WELCOME_TITLE</li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <div class="row" style="margin:10px">
        <div class="col-md-12">
            <div id="target-distribution">
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">@TargetController.TARGETDISTRIBUTION_TITLE</h3>
                    </div>
                    <div id="target-distribution-assign" class="box-body">
                        @{
                            Html.RenderPartial(TargetController._TARGETDISTRIBUTIONASSIGN, Model);
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
                                function target_line_changed(val) {
                                    var sum = Number(0);

                                    $("#target-row").find("input[name*='].Target']").each(function () {
                                        sum = sum + Number($(this).val());
                                    })
                                    $("input[name='TotalTarget']").val(sum)
                                    var prefix = val.getAttribute("name").split(".")[0] + "_";
                                    var source = val.getAttribute("name").split(".")[1];
                                    var temp = ('#' + prefix + "AvilableTarget").replace('[', '_').replace(']', '_')
                                    var avilableTarget = Number($(temp).text())
                                    var allocation = Number(0);
                                    var target = Number(0);
                                    switch (source) {
                                        case 'Allocation':
                                            var temp = ("#" + prefix + "Allocation").replace('[', '_').replace(']', '_')
                                            allocation = Number($(temp).val())
                                            var temp = ("#" + prefix + "Target").replace('[', '_').replace(']', '_')
                                            $(temp).val(avilableTarget * allocation / 100)
                                            break;
                                        case 'Target':
                                            var temp = ("#" + prefix + "Target").replace('[', '_').replace(']', '_')
                                            target = Number($(temp).val())
                                            var temp = ("#" + prefix + "Allocation").replace('[', '_').replace(']', '_')
                                            $(temp).val((target / avilableTarget) * 100)
                                            break;
                                    }
                                }
                                function user_changed(val) {
                                    //alert(val.value);
                                }
</script>