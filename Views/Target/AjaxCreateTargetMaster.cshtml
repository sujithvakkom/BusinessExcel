

@using BusinessExcel.Models
@using BusinessExcel.Controllers
@using BootstrapHtmlHelper
@using BusinessExcel.Providers.ProviderContext
@using BusinessExcel.Providers.ProviderContext.Entities
@using BusinessExcel.Controllers.JSON


@model TargetMaster



@*@using (Ajax.BeginForm(
                                                                           actionName: BusinessExcel.Controllers.TargetController.AJAXCREATETARGETMASTER,
                                                                            routeValues: null,
                                                                            ajaxOptions: new AjaxOptions()
                                                                            {
                                                                                UpdateTargetId = "target-master-creation-form",
                                                                                InsertionMode = InsertionMode.Replace,
                                                                                OnSuccess = "masterSaved",
                                                                                OnFailure = ""
                                                                            },
                                                                            htmlAttributes: new { @class = "form-inline" })
                                                                                                                                                                                                                )
{*@


    <div class="row">






        <div class="col-md-3">

            @Html.AdminLTETextBoxFor(m => m.description,
                    null,
                    new Dictionary<string, object>() { { "class", "form-control" }, { "autocomplete", "off" } },
                    null,
                    null,
                    "",
                    true,
                    true,
                    true)


        </div>

        <div class="col-md-3">

            @Html.AdminLTETextBoxFor(m => m.incentive_pct,
                    null,
                    new Dictionary<string, object>() { { "class", "form-control" }, { "autocomplete", "off" }, { "maxlength", 5 }, { "onkeypress", "return isNumberKey(event)" }, { "onkeyup", "this.value = minmax(this.value, 0, 100)" } },
                    null,
                    null,
                    "",
                    true,
                    true,
                    true)


        </div>

    </div>


<div style="font-size:large">
    @ViewData[BusinessExcel.Controllers.TargetController.TARGETCREATIONMESSAGE]
</div>


    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary" id="target-detail-form">
                <div class="box-body" style="padding:10px">
                    <div id="target-details-creation-form">
                        @Html.Action(BusinessExcel.Controllers.TargetController.TARGELIST
                      )

                    </div>


                </div>

            </div>

        </div>

    </div>

    <div class="col-md-2">

        <input type="submit" value="SAVE TARGET" class="btn btn-primary save" id="save" />
    </div>

@*//}*@

<script>




    function isNumberKey(evt){
        var charCode = (evt.which) ? evt.which : event.keyCode
        var str = document.getElementById('incentive_pct').value;


        if ((str.indexOf('.') >= 0) && (charCode == 46)) {

            return false;

        }// checking that length ==0 than not allow to enter '.'

        if (charCode == 46) {
            return true
        }
        else if ((charCode > 31 && (charCode < 48 || charCode > 57)))
            return false;
        return true;
    }

    function minmax(value, min, max) {
        if (parseInt(value) < min || isNaN(parseInt(value)))
            return '';
        else if (parseInt(value) > max)
            return 100;
        else return value;
    }


    $(document).on('click', '.save', function () {

       
        var description = $('#description').val();

        var incentive_pct = $('#incentive_pct').val();


        var master = {

            description: description,
            incentive_pct: incentive_pct

        };









        var arr = {
            value: 600, has_bonus: true, category_id: 1, target_id: 1, model_id: 1, target_qty: 0, target_line_id: 1

        };

        //list.push(arr);

        $.ajax({

            // edit to add steve's suggestion.
            //url: "/ControllerName/ActionName",

            url: '@Url.Action(BusinessExcel.Controllers.TargetController.TARGETMASTERSAVE, BusinessExcel.Controllers.TargetController.TARGETCONTROLLER)',
            // dataType: 'html',
            dataType: "html",
            data: JSON.stringify(master),
            type: "POST",
            contentType: "application/json; charset=utf-8",

            //  contentType: 'application/json; charset=utf-8',
            // dataType: 'json',




            //data: ({
            //    //insert your parameters to pass to controller
            //    id: roster_id
            //}),
            success: function (data) {
                // your data could be a View or Json or what ever you returned in your action method
                // parse your data here
                //alert(data);

                if (data != 0) {

                    // tr.css("background-color", "Red").delay(100).show().fadeOut('slow');;
                 
                    masterSaved(data);

                    //  $('#successMessage').html("Roster deleted successfully").delay(2000).show().fadeOut('slow');
                }
            },
            begin: function () {
                // $('#role-table-display').modal('hide')
            }
        })
    });

</script>  


